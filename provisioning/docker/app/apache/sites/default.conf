<VirtualHost *:80>
	ServerName dev.secretsantaorganizer.com

	ServerAdmin webmaster@localhost
	DocumentRoot /var/www/html/web

	# Fix for vagrant on windows
    EnableSendfile off

    RewriteEngine On
    RewriteCond %{HTTP_HOST} !dev.secretsantaorganizer.com [NC]
    RewriteRule ^(.*)$ https://dev.secretsantaorganizer.com$1 [L,R=301]

    RewriteRule ^/([a-z]{2})/entry(/.+)/?$ $1/participant$2 [L,R=301]
    RewriteRule ^/(zh-Hans|zh-hant)/entry(/.+)/?$ $1/participant$2 [L,R=301]
    Redirect 301 /entry/ https://www.secretsantaorganizer.com/participant/

    Redirect 301 /ch http://www.secretsantaorganizer.com/zh-Hans/
    Redirect 301 /nl/what http://www.secretsantaorganizer.com/nl/faq
    Redirect 301 /nl/questions http://www.secretsantaorganizer.com/nl/faq
    Redirect 301 /nl/lost http://www.secretsantaorganizer.com/nl/faq
    Redirect 301 /nl/combinations http://www.secretsantaorganizer.com/nl/faq
    Redirect 301 /fr/combinations http://www.secretsantaorganizer.com/fr/faq
    Redirect 301 /es/combinations http://www.secretsantaorganizer.com/es/faq
    Redirect 301 /es/lost http://www.secretsantaorganizer.com/es/faq
    Redirect 301 /fr/lost http://www.secretsantaorganizer.com/fr/faq
    Redirect 301 /fr/what http://www.secretsantaorganizer.com/fr/faq
    Redirect 301 /questions http://www.secretsantaorganizer.com/faq
    Redirect 301 /lost http://www.secretsantaorganizer.com/faq
    Redirect 301 /combinations http://www.secretsantaorganizer.com/faq
    Redirect 301 /fr/questions http://www.secretsantaorganizer.com/fr/faq
    Redirect 301 /404 http://www.secretsantaorganizer.com/faq
    Redirect 301 /what http://www.secretsantaorganizer.com/faq
    Redirect 301 /FR/index.oo-software.htm http://www.secretsantaorganizer.com/fr/faq
    Redirect 301 /privacy-policy https://www.secretsantaorganizer.com/privacy

    Header always set Strict-Transport-Security "max-age=3600"

    Header set X-Frame-Options SAMEORIGIN
    Header set X-Xss-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"

    <Directory />
        Options FollowSymLinks
        AllowOverride None
    </Directory>

    # Directory = DocumentRoot set above
    <Directory /vagrant/web>
        Options -Indexes +FollowSymLinks -MultiViews
        AllowOverride All
        Require all granted

        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteRule ^(.*)$ app.php [QSA,L]
        </IfModule>
    </Directory>

	LogLevel warn

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

    ErrorDocument 503 /503.html

</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet


